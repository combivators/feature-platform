<!DOCTYPE html>
<!--  http://www.goat1000.com/tagcanvas.php -->
<!--  http://www.goat1000.com/tagcanvas-options.php -->
<html>
<head>
<meta charset="utf-8" />
  <title>TagCanvas with weighted tags</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- load the CSS files in the right order -->
  <link href="bootstrap-4.3.1/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <link href="fontawesome-free-5.11.2-web/css/all.min.css" rel="stylesheet" type="text/css" />

  <style>
  </style>
</head>
<body>
<div class="container" id="container">
  <h1>TagCanvas - HTML5 Canvas Tag Cloud</h1>
  <div class="centred" style="width: 100%; max-width: 602px">
    <canvas id="tagcanvas" width="560" height="400" style="max-width: 560px; width: 100%">
      <img src="images/tagcanvas.png" width="200" height="150" />
    </canvas>
    <div style="text-align: center">
      <div class="custom-control custom-switch">
        <input type="checkbox" class="custom-control-input" id="modeSwitch" onchange="changeMode(this);">
        <label class="custom-control-label" for="modeSwitch">Image</label>
      </div>
      <div class="custom-control custom-switch">
        <input type="checkbox" class="custom-control-input" id="bgSwitch" onchange="changeBackground(this);">
        <label class="custom-control-label" for="bgSwitch">Background</label>
      </div>
      <button type="button" class="btn btn-primary" onclick="changeShape('sphere')"><i class="fas fa-arrows-alt"></i></button>
      <button type="button" class="btn btn-primary" onclick="changeShape('hcylinder')"><i class="fas fa-arrows-alt-v"></i></button>
      <button type="button" class="btn btn-primary" onclick="changeShape('vcylinder')"><i class="fas fa-arrows-alt-h"></i></button>
      <button type="button" class="btn btn-primary" onclick="changeHelixShape()"><i class="fas fa-infinity"></i></button>
      <button type="button" class="btn btn-primary" onclick="changeType(this)"><i class="fas fa-adjust"></i></button>
    </div>
    <p>You clicked on: <em id=sout style=color:#900>&hellip;nothing yet!</em></p>
  </div> <!-- centred -->

  <div style="display: none">
  <div id="tags">
    <ul id="weightTags" class="weighted" style="font-size: 50%">
    </ul>
  <!--
    <ul>
      <li><a href="#fake1" onclick="return tpu(this)">Fake link 1</a></li>
      <li><a href="#fake2" onclick="return tpu(this)">Fake link 2</a></li>
      <li><a href="#fake3" onclick="return tpu(this)">Fake link 3</a></li>
      <li><a href="#fake4" onclick="return tpu(this)">Fake link 4</a></li>
      <li><a href="#fake5" onclick="return tpu(this)">Fake link 5</a></li>
      <li><a href="#fake6" onclick="return tpu(this)">Fake link 6</a></li>
    </ul>
    <ul>
      <li><a href="#" onclick="return tpu(this)">SVGGraph</a></li>
      <li><a href="#" onclick="return tpu(this)">JPEG Saver</a></li>
      <li><a href="#" onclick="return tpu(this)">Downloads</a></li>
      <li><a href="#" onclick="return tpu(this)">Google</a></li>
      <li><a href="#" onclick="return tpu(this)">Yahoo!</a></li>
      <li><a href="#" onclick="return tpu(this)">Microsoft</a></li>
      <li><a href="#" onclick="return tpu(this)">BBC</a></li>
    </ul>
  -->
  </div>
<!--
  <div id="iconTags">
    <a href="#01" onclick="return tpu(this)"><img src="images/icon-01.png" alt="Icon 01" /></a>
    <a href="#02" onclick="return tpu(this)"><img src="images/icon-02.png" alt="Icon 02" /></a>
    <a href="#03" onclick="return tpu(this)"><img src="images/icon-03.png" alt="Icon 03" /></a>
    <a href="#04" onclick="return tpu(this)"><img src="images/icon-04.png" alt="Icon 04" /></a>
    <a href="#05" onclick="return tpu(this)"><img src="images/icon-05.png" alt="Icon 05" /></a>
    <a href="#06" onclick="return tpu(this)"><img src="images/icon-06.png" alt="Icon 06" /></a>
    <a href="#07" onclick="return tpu(this)"><img src="images/icon-07.png" alt="Icon 07" /></a>
    <a href="#08" onclick="return tpu(this)"><img src="images/icon-08.png" alt="Icon 08" /></a>
    <a href="#09" onclick="return tpu(this)"><img src="images/icon-09.png" alt="Icon 09" /></a>
    <a href="#10" onclick="return tpu(this)"><img src="images/icon-10.png" alt="Icon 10" /></a>
    <a href="#11" onclick="return tpu(this)"><img src="images/icon-11.png" alt="Icon 11" /></a>
    <a href="#12" onclick="return tpu(this)"><img src="images/icon-12.png" alt="Icon 12" /></a>
    <a href="#13" onclick="return tpu(this)"><img src="images/icon-13.png" alt="Icon 13" /></a>
    <a href="#14" onclick="return tpu(this)"><img src="images/icon-14.png" alt="Icon 14" /></a>
    <a href="#15" onclick="return tpu(this)"><img src="images/icon-15.png" alt="Icon 15" /></a>
    <a href="#16" onclick="return tpu(this)"><img src="images/icon-16.png" alt="Icon 16" /></a>
    <a href="#17" onclick="return tpu(this)"><img src="images/icon-17.png" alt="Icon 17" /></a>
    <a href="#18" onclick="return tpu(this)"><img src="images/icon-18.png" alt="Icon 18" /></a>
    <a href="#19" onclick="return tpu(this)"><img src="images/icon-19.png" alt="Icon 19" /></a>
    <a href="#20" onclick="return tpu(this)"><img src="images/icon-20.png" alt="Icon 20" /></a>
  </div>
 -->
  </div>
</div><!-- container -->
</body>
<!--[if lt IE 9]><script src="tagcanvas/2.9/excanvas.js" type="text/javascript" ></script><![endif]-->
<script src="jquery/jquery-3.4.1.min.js"></script>
<script src="popper.js/1.16.0/popper.min.js"></script>
<script src="bootstrap-4.3.1/js/bootstrap.min.js"></script>
<!--
<script src="tagcanvas/2.9/jquery.tagcanvas.min.js"></script>
-->
<script src="tagcanvas/2.9/jquery.tagcanvas-1.js"></script>
<script>
var entries = [
    { image: 'images/icon-01.png', width: '30', height: '30', url: '#01', target: '_top', tooltip: '*Ad1', weight: '14'},
    { image: 'images/icon-02.png', width: '30', height: '30', url: '#02', target: '_top', tooltip: '*Ad2', weight: '28' },
    { image: 'images/icon-03.png', width: '30', height: '30', url: '#03', target: '_top', tooltip: '*Ad3', weight: '32' },
    { image: 'images/icon-04.png', width: '30', height: '30', url: '#04', target: '_top', tooltip: 'G.OO', weight: '40' },
    { image: 'images/icon-05.png', width: '30', height: '30', url: '#05', target: '_top', tooltip: 'Y.AH', weight: '22' },
    { image: 'images/icon-06.png', width: '30', height: '30', url: '#06', target: '_top', tooltip: 'M.IC', weight: '40' },
    { image: 'images/icon-07.png', width: '30', height: '30', url: '#07', target: '_top', tooltip: 'J.W' , weight: '30' },
    { image: 'images/icon-08.png', width: '30', height: '30', url: '#08', target: '_top', tooltip: 'X.HM', weight: '21' },
    { image: 'images/icon-09.png', width: '30', height: '30', url: '#09', target: '_top', tooltip: 'L.XX', weight: '50' },
    { image: 'images/icon-10.png', width: '30', height: '30', url: '#10', target: '_top', tooltip: 'C.H' , weight: '34' },
    { image: 'images/icon-11.png', width: '30', height: '30', url: '#11', target: '_top', tooltip: '#IBM', weight: '41'},
    { image: 'images/icon-12.png', width: '30', height: '30', url: '#12', target: '_top', tooltip: '#Y!J', weight: '32' },
    { image: 'images/icon-13.png', width: '30', height: '30', url: '#13', target: '_top', tooltip: '#NRI', weight: '25' },
    { image: 'images/icon-14.png', width: '30', height: '30', url: '#14', target: '_top', tooltip: 'R.SH', weight: '40' },
    { image: 'images/icon-15.png', width: '30', height: '30', url: '#15', target: '_top', tooltip: 'W.SK', weight: '28' },
    { image: 'images/icon-16.png', width: '30', height: '30', url: '#16', target: '_top', tooltip: 'T.RB', weight: '42' },
    { image: 'images/icon-17.png', width: '30', height: '30', url: '#17', target: '_top', tooltip: 'E.BJ', weight: '36' },
    { image: 'images/icon-18.png', width: '30', height: '30', url: '#18', target: '_top', tooltip: 'Y.TS', weight: '48' },
    { image: 'images/icon-19.png', width: '30', height: '30', url: '#19', target: '_top', tooltip: 'I.GO', weight: '24' },
    { image: 'images/icon-20.png', width: '30', height: '30', url: '#20', target: '_top', tooltip: 'L.SM', weight: '34' }
  ];
var gradient = {
   0:    '#f00', // red
   0.33: '#ff0', // yellow
   0.66: '#0f0', // green
   1:    '#00f'  // blue
};
/*
var gradients = [{
   0:   'red',            // red
   0.5: 'orange',         // orange
   1:   'rgba(0,0,0,0.1)' // black, but 90% transparent
  }, {
   0:   '#000',           // black
   1:   '#fff'            // white
  }
];

var oopts = {
   textFont: 'Impact,Arial Black,sans-serif',
   textHeight: 20,
   minSpeed: 0.01,
   maxSpeed: 0.05,
   decel: 0.9,
   depth: 0.99,
   outlineColour: '#f6f',
   outlineThickness: 3,
   pulsateTo: 0.2,
   pulsateTime: 0.5,
   wheelZoom: false
  };
*/
var weightOptions = {
   colour: { weightMode: 'colour' },
   both: { weightMode: 'both' },
   bgcolour: { weightMode: 'bgcolour', padding: 2, bgRadius: 5 },
   bgoutline: { weightMode:'bgoutline', bgOutlineThickness: 3, padding: 2, bgRadius: 5},
};

var ttags = 'weightTags', lock, shape = 'sphere', mode = 'text', wopt ='colour', opts = weightOptions[wopt];

window.onload = function() {
  TagCanvas.textFont = 'Trebuchet MS, Helvetica, sans-serif';
  TagCanvas.textColour = '#00f';
  TagCanvas.textHeight = 25;
  TagCanvas.outlineMethod = 'block';
  TagCanvas.outlineColour = '#acf';
  TagCanvas.outlineThickness = 5;
  TagCanvas.minSpeed = 0.01;
  TagCanvas.maxSpeed = 0.03;
  TagCanvas.minBrightness = 0.2;
  TagCanvas.depth = 0.92;
  TagCanvas.pulsateTo = 0.6;
  TagCanvas.initial = [0.1,-0.1];
  TagCanvas.decel = 0.98;
  TagCanvas.reverse = true;
  TagCanvas.hideTags = false;
  TagCanvas.shadow = '#ccf';
  TagCanvas.shadowBlur = 3;
  TagCanvas.weight = true;
  TagCanvas.weightFrom = 'data-weight';
  TagCanvas.weightMode = 'both';
  TagCanvas.weightGradient = gradient;
  TagCanvas.imageScale = null;
  TagCanvas.imageMode = mode;
  TagCanvas.fadeIn = 1000;
  TagCanvas.clickToFront = 600;
  try {
    appendTags('weightTags', entries);
    TagCanvas.Start('tagcanvas','weightTags', opts);
  } catch(e) {
    console.log("Error!");
    document.getElementsByTagName('canvas')[0].style.border='0';
  }
};

function restart() {
  TagCanvas.shape = shape;
  TagCanvas.imageMode = mode;
  TagCanvas.lock = lock;
  TagCanvas.Start('tagcanvas',ttags, opts);
}

function changeShape(s) {
  var locks = { hcylinder: 'x', vcylinder: 'y', hring: 'x', vring: 'y', sphere: '' };
  lock = locks[s] || '';
  shape = s;
  TagCanvas.initial = (lock == 'x' && [0,0.2]) || (lock == 'y' && [0.2,0]) || [0.2,0.2];
  restart();
}

function changeBackground(e) {
  document.getElementById('tagcanvas').style.backgroundImage = (e.checked ? 'url(images/canvas_bg1.png)' : 'none');
}

//Add 2019/11/13
function changeMode(e) {
  if (mode != 'text') {
    mode = 'text';
  } else if(mode != 'image') {
    mode = 'image';
  }
  restart();
}

function changeType(e){
  if (mode != 'image') {
    if (wopt == 'colour') {
      wopt = 'both';
    } else if(wopt == 'both') {
      wopt = 'bgcolour';
    } else if(wopt == 'bgcolour') {
      wopt = 'bgoutline';
    } else if(wopt == 'bgoutline') {
      wopt = 'colour';
    }
    opts = weightOptions[wopt];
    restart();
  }
}

//双螺旋
function changeHelixShape() {
　if (opts['shape'] == 'helix') {
    opts = {shape: "PointsOnSphere", lock: "x" };
　} else {
    opts = {shape: "helix", lock: "x" };
  }
  restart();
}

//双螺旋
function helix(n, rx, ry, rz) {
  var a = Math.PI / n, i, j, p = [],
    z = rz * 2 / n;
  for(i = 0; i < n; ++i) {
    j = a * i;
    if(i % 2)
      j += Math.PI;
    p.push([rx * Math.cos(j),
      rz - z * i,
      ry * Math.sin(j)]);
  }
  return p;
}

function appendTags(id, e) {
  var weightTags = document.getElementById(id);
  console.log("appendTags " + e.length);
  for (var i=0; i<e.length; i++) {
    appendTag(weightTags, e[i]);
  }
}

function appendTag(ul, e) {
  var li = document.createElement("li");
  var anchor = document.createElement("a");
  anchor.setAttribute('href', e.url);
  //anchor.target = e.target;
  //anchor.setAttribute('data-toggle', 'tooltip');
  //anchor.setAttribute('title', e.tooltip);
  //anchor.setAttribute('onclick', 'return tpu(this)');
  anchor.setAttribute('data-weight', e.weight);
  var img = document.createElement("img");
  img.src = e.image;
  anchor.appendChild(img);
  var content = document.createTextNode(e.tooltip);
  anchor.appendChild(content);
  li.appendChild(anchor);
  ul.appendChild(li);
  //Listen for the event.
  anchor.addEventListener('click', function(e){
    // Clicked anchor callback
    console.log("Callback Clicked href=" + anchor.href);
    document.getElementById('sout').innerHTML = anchor.innerHTML;
    }, false);

}
</script>

</html>